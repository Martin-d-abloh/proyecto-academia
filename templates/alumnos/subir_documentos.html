{% extends "base.html" %}
{% block content %}
    <h1>Subir documentos para {{ alumno.nombre }} {{ alumno.apellidos }}</h1>

    <form method="POST" enctype="multipart/form-data">
        {% if alumno.todo_bien %}
        <p style="color: green; font-weight: bold;">
            ‚úÖ Ya has subido todos los documentos. Si lo necesitas, puedes volver a subirlos.
        </p>
    {% endif %}
    
        <ul>
            {% for nombre_doc, info in alumno.documentos.items() %}
                <li>
                    <label>{{ nombre_doc }}:</label>

                    {% if info.estado %}
                        ‚úÖ Subido

                        <!-- Bot√≥n de descarga -->
                        <a href="{{ url_for('descargar_documento', alumno_id=alumno.id, documento=nombre_doc) }}">Descargar</a>
                    {% else %}
                        <input type="file" 
                               name="{{ nombre_doc }}" 
                               accept=".pdf,.doc,.jpg,.jpeg,.png"
                               autocomplete="off">
                    {% endif %}
                </li>
            {% endfor %}
        </ul>

        <button type="submit">Subir documentos</button>
    </form>

    <!-- Formularios de eliminaci√≥n fuera del form principal -->
    <ul>
        {% for nombre_doc, info in alumno.documentos.items() if info.estado %}
            <li style="margin-top: 10px;">
                <form action="{{ url_for('eliminar_documento', alumno_id=alumno.id, documento=nombre_doc) }}"
                      method="POST"
                      onsubmit="return confirm('¬øSeguro que quieres eliminar este archivo?')"
                      style="display:inline;">
                    <button type="submit" style="background:none; border:none; cursor:pointer;">
                        üóëÔ∏è Eliminar {{ nombre_doc }}
                    </button>
                </form>
            </li>
        {% endfor %}
    </ul>
{% endblock %}
